# Docker Compose Environment Configuration
# Copy this file to .env and fill in your values

# Security Configuration
# Generate a secure JWT secret with: openssl rand -base64 32
JWT_SECRET=your-super-secret-jwt-key-change-this-in-production

# JWT token expiration in hours (default: 24)
JWT_EXPIRY_HOURS=24

# MFA Encryption Key for securing TOTP secrets
# Generate with: openssl rand -hex 32
MFA_ENCRYPTION_KEY=your-64-character-hex-encryption-key-change-this-in-production

# Environment
ENVIRONMENT=development

# MFA Policy
# Require admins to set up MFA (recommended). Set to false to disable during local/dev.
# Accepted values: true/false, 1/0, yes/no, on/off (case-insensitive)
REQUIRE_ADMIN_MFA=true

# Server Configuration
PORT=8080
# Host binding - use 127.0.0.1 for local only, 0.0.0.0 for all interfaces
HOST=0.0.0.0

# Rate Limiting Configuration
# Max requests per IP per minute for unauthenticated users
RATE_LIMIT_PER_MINUTE=60
# Rate limiting for authenticated users (higher limit)
AUTH_RATE_LIMIT_PER_MINUTE=600
# Session timeout in minutes (for admin operations)
SESSION_TIMEOUT_MINUTES=30

# File Upload Configuration
# Allowed file upload types (comma-separated)
ALLOWED_FILE_TYPES=pdf,jpg,jpeg,png,gif,webp,txt,doc,docx,xls,xlsx
# Maximum file size in MB
MAX_FILE_SIZE_MB=50

# CORS Configuration
# Frontend URL for CORS
FRONTEND_URL=http://localhost:3000
# Additional allowed origins (comma-separated, optional)
ADDITIONAL_CORS_ORIGINS=

# Logging Configuration
# Set overall log level (error, warn, info, debug, trace)
# Use 'info' for development (less verbose), 'debug' for detailed debugging
RUST_LOG=info

# Microsoft Entra ID Configuration (Optional)
# Leave empty if not using Microsoft authentication
MICROSOFT_CLIENT_ID=
MICROSOFT_TENANT_ID=
MICROSOFT_CLIENT_SECRET=
MICROSOFT_REDIRECT_URI=http://localhost:3000/auth/microsoft/callback

# ===== OpenID Connect (OIDC) Configuration =====
# Generic OIDC provider support for any compatible identity provider
# (Keycloak, Auth0, Okta, Google, GitLab, Authentik, Authelia, etc.)

# Required: OIDC Client credentials
OIDC_CLIENT_ID=
OIDC_CLIENT_SECRET=

# Option 1: Auto-discovery (Recommended)
# Just provide the issuer URL and endpoints are discovered automatically
OIDC_ISSUER_URL=

# Option 2: Manual configuration (if provider doesn't support discovery)
# Only needed if OIDC_ISSUER_URL is not set
# OIDC_AUTH_URI=https://your-provider.com/authorize
# OIDC_TOKEN_URI=https://your-provider.com/token
# OIDC_USERINFO_URI=https://your-provider.com/userinfo

# Redirect URI for OIDC callback (must match provider configuration)
OIDC_REDIRECT_URI=http://localhost:3000/auth/oidc/callback

# Optional: Customize the display name shown on login button (default: "OpenID")
OIDC_DISPLAY_NAME=SSO

# Optional: Scopes to request (default: "openid profile email")
# OIDC_SCOPES=openid profile email

# Optional: Claim to use for username (default: "preferred_username")
# Options: preferred_username, email, name, sub
# OIDC_USERNAME_CLAIM=preferred_username

# Optional: Logout URL for single logout
# OIDC_LOGOUT_URI=https://your-provider.com/logout

# Optional: Set to true to prevent auto-redirect to OIDC provider
# OIDC_DISABLE_REDIRECT=false

# PostgreSQL Configuration (Optional - uses defaults if not set)
POSTGRES_DB=helpdesk
POSTGRES_USER=nosdesk
POSTGRES_PASSWORD=nosdesk_password

# Database Configuration
DATABASE_URL=postgres://nosdesk:nosdesk_password@postgres:5432/helpdesk
# Database connection pool configuration
DB_MAX_CONNECTIONS=10
DB_MIN_CONNECTIONS=1
DB_CONNECTION_TIMEOUT=30
# Database SSL configuration (set to require for production)
DB_SSL_MODE=prefer

# Redis Configuration (Optional - uses defaults if not set)
REDIS_PASSWORD=nosdesk_redis_password
# Redis URL for distributed rate limiting (optional - fallback to in-memory)
REDIS_URL=redis://:nosdesk_redis_password@redis:6379

# Microsoft Graph Sync Configuration (Optional)
# Concurrent processing and batch sizing
MSGRAPH_CONCURRENT_PROCESSING=5
MSGRAPH_USER_BATCH_SIZE=10

# Skip disabled user accounts during sync (default: true)
# Set to false if you want to sync disabled accounts as well
MSGRAPH_SKIP_DISABLED_ACCOUNTS=true

# Email Configuration (SMTP)
# Enable/disable email functionality
SMTP_ENABLED=false
# SMTP server hostname
SMTP_HOST=smtp.gmail.com
# SMTP server port (587 for STARTTLS, 465 for SSL)
SMTP_PORT=587
# SMTP authentication username
SMTP_USERNAME=your-email@example.com
# SMTP authentication password or app-specific password
SMTP_PASSWORD=your-smtp-password
# Display name for sent emails
SMTP_FROM_NAME=Nosdesk
# From email address (defaults to SMTP_USERNAME if not set)
SMTP_FROM_EMAIL=noreply@yourdomain.com
